<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <link rel="icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
      integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2"
      crossorigin="anonymous"
    />
    <!-- Font Awesome CSS -->
    <link
      href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
      rel="stylesheet"
    />
    <link href="/public/index.css" rel="stylesheet" />
    <title>세탁센터 | 사장님</title>
  </head>

  <body>
    <div
      class="jumbotron bg-sparta text-white text-center"
      style="background-color: rgb(3, 3, 117)"
      onclick="window.location.href='/api/laundry'"
    >
      <h1 class="font-weight-bold">스파르타 세탁소</h1>
    </div>

    <span id="ownerInfo">
    <div class="container" style="margin-top: 50px">
        <h2 class="col" style="text-align: center; margin-bottom: 20px">
        안녕하세요 <%= shopName %>님
        </h2>
      </div>

    <div class="container" style="margin-top: 50px">
      <h4 class="col" style="text-align: center; margin-bottom: 20px">
        현재 보유 포인트 
      </h4>
      <h4 class="col" style="text-align: center; margin-bottom: 50px">
        <%= ownerPoint %>점
      </h4>
    </div>
    </span>

    <div style="text-align:center; margin-bottom: 30px">
      <button onclick="open_laundry_list()" type="button" class="btn btn-dark btn-lg" style="margin-right: 15px">세탁물 조회</button>
      <button onclick="open_myWork_list()" type="button" class="btn btn-warning btn-lg">작업물 조회</button>
    </div>

    <div class= "laundry_list" id="laundry_list">
    </div>



    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script
      src="https://code.jquery.com/jquery-3.5.1.js"
      integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
      integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js"
      integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s"
      crossorigin="anonymous"
    ></script>

    <script src="/api.js"></script>

    <script>

        function open_laundry_list() {
            $('#laundry_list').show()
        }

        function close_laundry_list() {
            $('#laundry_list').hide()
        }

        function open_myWork_list() {
            $('#myWork_list').show()
        }

        function close_myWork_list() {
            $('#myWork_list').hide()
        }
        

        // 세탁물 불러오기
        $(document).ready(function () {
            laundry_list();
        });

        function laundry_list() {
            $.ajax({
                type: "GET",
                url: "/api/laundries/owner/laundry_list",
                data: {},
                success: function (response) {
                    let rows = response['laundries']
                    for (let i = 0; i < rows.length; i++) {
                        let laundryId = rows[i]['laundryId']
                        let laundryName = rows[i]['laundryName']
                        let request = rows[i]['request']
                        let img = rows[i]['img']
                        let status = rows[i]['status']
                        let createdAt = rows[i]['createdAt']

                        let temp_html = `<table class="laundry">
                                        <thead class="table-dark">
                                        <tr>
                                            <th scope="col">#</th>
                                            <th scope="col">세탁물</th>
                                            <th scope="col">요청사항</th>
                                            <th scope="col">사진</th>
                                            <th scope="col">상태</th>
                                            <th scope="col">생성일</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <th scope="row">${laundryId}</th>
                                            <td >${laundryName}</td>
                                            <td>${request}</td>
                                            <td>${img}</td>
                                            <td>${status}</td>
                                            <td>${createdAt}</td>
                                        </tr>
                                        </tbody>
                                    </table>`
                        $('#laundry_list').append(temp_html)
                    }
                }
            });
        }

        


    </script>
  </body>
</html>
